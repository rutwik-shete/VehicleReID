==========
Args:Namespace(adam_beta1=0.9, adam_beta2=0.999, arch='resnet50', color_aug=False, color_jitter=False, eval_freq=1, evaluate=False, gamma=0.1, gpu_devices='0', height=224, label_smooth=False, lambda_htri=1, lambda_xent=1, load_weights='', lr=0.0003, lr_scheduler='multi_step', margin=0.3, max_epoch=4, momentum=0.9, no_pretrained=False, num_instances=4, optim='amsgrad', print_freq=10, query_remove=True, random_erase=False, resume='', rmsprop_alpha=0.99, root='/mnt/fast/nobackup/users/rs01960/AdvanceCV', save_dir='/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003', seed=1, sgd_dampening=0, sgd_nesterov=False, source_names=['veri'], split_id=0, start_epoch=0, start_eval=0, stepsize=[20, 40], target_names=['veri'], test_batch_size=100, test_size=800, train_batch_size=64, train_sampler='RandomSampler', use_avai_gpus=False, use_cpu=False, visualize_ranks=False, weight_decay=0.0005, width=224, workers=8)
==========
Value Of GPU :  True
Currently using GPU 0
Initializing image data manager
=> Initializing TRAIN (source) datasets
=> VeRi loaded
Image Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   576 |    37778 |        20
  query    |   200 |     1678 |        19
  gallery  |   200 |    11579 |        19
  ----------------------------------------
=> Initializing TEST (target) datasets
=> VeRi loaded
Image Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   576 |    37778 |        20
  query    |   200 |     1678 |        19
  gallery  |   200 |    11579 |        19
  ----------------------------------------


  **************** Summary ****************
  train names      : ['veri']
  # train datasets : 1
  # train ids      : 576
  # train images   : 37778
  # train cameras  : 20
  test names       : ['veri']
  *****************************************


Initializing model: resnet50
Initialized model with pretrained weights from https://download.pytorch.org/models/resnet50-19c8e357.pth
Model size: 23.508 M
=> Start training
Epoch: [1][10/590]	Time 0.276 (1.263)	Data 0.0003 (0.0732)	Xent 6.6523 (6.4841)	Htri 0.3044 (0.4536)	Acc 0.00 (0.78)	
Epoch: [1][20/590]	Time 0.280 (0.770)	Data 0.0003 (0.0367)	Xent 6.3097 (6.5102)	Htri 0.2843 (0.3970)	Acc 3.12 (1.17)	
Epoch: [1][30/590]	Time 0.280 (0.606)	Data 0.0004 (0.0246)	Xent 6.0912 (6.4319)	Htri 0.2800 (0.3565)	Acc 1.56 (1.72)	
Epoch: [1][40/590]	Time 0.277 (0.524)	Data 0.0001 (0.0185)	Xent 6.0522 (6.3388)	Htri 0.0462 (0.3685)	Acc 0.00 (1.76)	
Epoch: [1][50/590]	Time 0.277 (0.475)	Data 0.0003 (0.0149)	Xent 6.0283 (6.2683)	Htri 0.3863 (0.3672)	Acc 9.38 (2.03)	
Epoch: [1][60/590]	Time 0.278 (0.442)	Data 0.0003 (0.0124)	Xent 5.7440 (6.2024)	Htri 0.2034 (0.3774)	Acc 3.12 (2.37)	
Epoch: [1][70/590]	Time 0.278 (0.419)	Data 0.0001 (0.0107)	Xent 5.7013 (6.1459)	Htri 0.6633 (0.3659)	Acc 1.56 (2.46)	
Epoch: [1][80/590]	Time 0.276 (0.401)	Data 0.0002 (0.0094)	Xent 5.5349 (6.0821)	Htri 0.2090 (0.3886)	Acc 4.69 (2.60)	
Epoch: [1][90/590]	Time 0.277 (0.387)	Data 0.0003 (0.0084)	Xent 5.7601 (6.0338)	Htri 0.2256 (0.3848)	Acc 4.69 (2.74)	
Epoch: [1][100/590]	Time 0.276 (0.376)	Data 0.0003 (0.0076)	Xent 5.8934 (5.9918)	Htri 0.4273 (0.3747)	Acc 1.56 (2.78)	
Epoch: [1][110/590]	Time 0.276 (0.367)	Data 0.0002 (0.0069)	Xent 5.3805 (5.9338)	Htri 0.8138 (0.3779)	Acc 1.56 (3.00)	
Epoch: [1][120/590]	Time 0.277 (0.360)	Data 0.0003 (0.0063)	Xent 5.0469 (5.8819)	Htri 0.7143 (0.3838)	Acc 4.69 (3.20)	
Epoch: [1][130/590]	Time 0.278 (0.353)	Data 0.0002 (0.0059)	Xent 5.0748 (5.8345)	Htri 0.4906 (0.3790)	Acc 7.81 (3.28)	
Epoch: [1][140/590]	Time 0.278 (0.348)	Data 0.0002 (0.0055)	Xent 5.3787 (5.7807)	Htri 0.3561 (0.3712)	Acc 1.56 (3.36)	
Epoch: [1][150/590]	Time 0.277 (0.343)	Data 0.0002 (0.0051)	Xent 4.6032 (5.7308)	Htri 0.1860 (0.3648)	Acc 9.38 (3.45)	
Epoch: [1][160/590]	Time 0.277 (0.339)	Data 0.0003 (0.0048)	Xent 4.8514 (5.6873)	Htri 0.7274 (0.3630)	Acc 10.94 (3.60)	
Epoch: [1][170/590]	Time 0.279 (0.335)	Data 0.0004 (0.0045)	Xent 4.8238 (5.6414)	Htri 0.2764 (0.3620)	Acc 10.94 (3.75)	
Epoch: [1][180/590]	Time 0.278 (0.332)	Data 0.0002 (0.0043)	Xent 4.5708 (5.5912)	Htri 0.8848 (0.3635)	Acc 7.81 (3.98)	
Epoch: [1][190/590]	Time 0.277 (0.329)	Data 0.0002 (0.0041)	Xent 4.6998 (5.5460)	Htri 0.2198 (0.3571)	Acc 7.81 (4.14)	
Epoch: [1][200/590]	Time 0.277 (0.327)	Data 0.0003 (0.0039)	Xent 4.4035 (5.4960)	Htri 0.5035 (0.3593)	Acc 3.12 (4.34)	
Epoch: [1][210/590]	Time 0.277 (0.324)	Data 0.0002 (0.0037)	Xent 4.6480 (5.4542)	Htri 0.5057 (0.3562)	Acc 6.25 (4.51)	
Epoch: [1][220/590]	Time 0.278 (0.322)	Data 0.0002 (0.0036)	Xent 4.4616 (5.4133)	Htri 0.5436 (0.3519)	Acc 7.81 (4.72)	
Epoch: [1][230/590]	Time 0.277 (0.320)	Data 0.0002 (0.0034)	Xent 4.6497 (5.3755)	Htri 0.0318 (0.3532)	Acc 7.81 (4.95)	
Epoch: [1][240/590]	Time 0.277 (0.319)	Data 0.0001 (0.0033)	Xent 4.5378 (5.3374)	Htri 0.6600 (0.3499)	Acc 10.94 (5.12)	
Epoch: [1][250/590]	Time 0.279 (0.317)	Data 0.0003 (0.0032)	Xent 4.0995 (5.2997)	Htri 0.5143 (0.3475)	Acc 7.81 (5.34)	
Epoch: [1][260/590]	Time 0.277 (0.315)	Data 0.0001 (0.0030)	Xent 4.2916 (5.2625)	Htri 0.2678 (0.3455)	Acc 15.62 (5.58)	
Epoch: [1][270/590]	Time 0.277 (0.314)	Data 0.0002 (0.0029)	Xent 4.5558 (5.2255)	Htri 0.2196 (0.3463)	Acc 10.94 (5.86)	
Epoch: [1][280/590]	Time 0.277 (0.313)	Data 0.0002 (0.0028)	Xent 4.0655 (5.1871)	Htri 0.5039 (0.3472)	Acc 7.81 (6.08)	
Epoch: [1][290/590]	Time 0.278 (0.311)	Data 0.0003 (0.0028)	Xent 3.9969 (5.1507)	Htri 0.4848 (0.3453)	Acc 14.06 (6.27)	
Epoch: [1][300/590]	Time 0.277 (0.310)	Data 0.0002 (0.0027)	Xent 4.0956 (5.1169)	Htri 0.2453 (0.3465)	Acc 7.81 (6.45)	
Epoch: [1][310/590]	Time 0.276 (0.309)	Data 0.0002 (0.0026)	Xent 4.0848 (5.0838)	Htri 0.4339 (0.3463)	Acc 12.50 (6.68)	
Epoch: [1][320/590]	Time 0.276 (0.308)	Data 0.0002 (0.0025)	Xent 3.9001 (5.0497)	Htri 0.4093 (0.3506)	Acc 14.06 (6.91)	
Epoch: [1][330/590]	Time 0.277 (0.307)	Data 0.0003 (0.0025)	Xent 4.2688 (5.0196)	Htri 0.1405 (0.3465)	Acc 12.50 (7.06)	
Epoch: [1][340/590]	Time 0.277 (0.306)	Data 0.0003 (0.0024)	Xent 3.7435 (4.9857)	Htri 0.3233 (0.3463)	Acc 9.38 (7.35)	
Epoch: [1][350/590]	Time 0.277 (0.306)	Data 0.0002 (0.0023)	Xent 3.7869 (4.9577)	Htri 0.8380 (0.3492)	Acc 12.50 (7.50)	
Epoch: [1][360/590]	Time 0.277 (0.305)	Data 0.0002 (0.0023)	Xent 3.6931 (4.9271)	Htri 0.5588 (0.3485)	Acc 20.31 (7.74)	
Epoch: [1][370/590]	Time 0.276 (0.304)	Data 0.0003 (0.0022)	Xent 3.7418 (4.8959)	Htri 0.1561 (0.3482)	Acc 12.50 (7.96)	
Epoch: [1][380/590]	Time 0.277 (0.303)	Data 0.0003 (0.0022)	Xent 4.0147 (4.8661)	Htri 0.1069 (0.3487)	Acc 15.62 (8.19)	
Epoch: [1][390/590]	Time 0.277 (0.303)	Data 0.0001 (0.0021)	Xent 3.6521 (4.8383)	Htri 0.3029 (0.3475)	Acc 17.19 (8.38)	
Epoch: [1][400/590]	Time 0.277 (0.302)	Data 0.0002 (0.0021)	Xent 3.6499 (4.8098)	Htri 0.2729 (0.3470)	Acc 9.38 (8.55)	
Epoch: [1][410/590]	Time 0.279 (0.301)	Data 0.0003 (0.0020)	Xent 3.8360 (4.7819)	Htri 0.6377 (0.3459)	Acc 15.62 (8.77)	
Epoch: [1][420/590]	Time 0.280 (0.301)	Data 0.0002 (0.0020)	Xent 3.9067 (4.7550)	Htri 0.5418 (0.3453)	Acc 17.19 (9.00)	
Epoch: [1][430/590]	Time 0.279 (0.300)	Data 0.0002 (0.0019)	Xent 3.3440 (4.7248)	Htri 0.4779 (0.3439)	Acc 17.19 (9.28)	
Epoch: [1][440/590]	Time 0.280 (0.300)	Data 0.0002 (0.0019)	Xent 3.6272 (4.6967)	Htri 0.1485 (0.3422)	Acc 15.62 (9.48)	
Epoch: [1][450/590]	Time 0.280 (0.300)	Data 0.0002 (0.0019)	Xent 3.5882 (4.6682)	Htri 0.2972 (0.3385)	Acc 15.62 (9.68)	
Epoch: [1][460/590]	Time 0.285 (0.299)	Data 0.0002 (0.0018)	Xent 3.4655 (4.6415)	Htri 0.4605 (0.3361)	Acc 26.56 (9.92)	
Epoch: [1][470/590]	Time 0.279 (0.299)	Data 0.0002 (0.0018)	Xent 3.2418 (4.6128)	Htri 0.3278 (0.3369)	Acc 20.31 (10.14)	
Epoch: [1][480/590]	Time 0.282 (0.298)	Data 0.0002 (0.0018)	Xent 3.1224 (4.5861)	Htri 0.4682 (0.3376)	Acc 23.44 (10.39)	
Epoch: [1][490/590]	Time 0.280 (0.298)	Data 0.0002 (0.0017)	Xent 3.6505 (4.5617)	Htri 0.0720 (0.3363)	Acc 14.06 (10.61)	
Epoch: [1][500/590]	Time 0.280 (0.298)	Data 0.0002 (0.0017)	Xent 3.1542 (4.5348)	Htri 0.1406 (0.3336)	Acc 23.44 (10.88)	
Epoch: [1][510/590]	Time 0.279 (0.297)	Data 0.0002 (0.0017)	Xent 3.1354 (4.5083)	Htri 0.0149 (0.3304)	Acc 21.88 (11.15)	
Epoch: [1][520/590]	Time 0.279 (0.297)	Data 0.0002 (0.0016)	Xent 3.3195 (4.4852)	Htri 0.0360 (0.3266)	Acc 28.12 (11.35)	
Epoch: [1][530/590]	Time 0.282 (0.297)	Data 0.0003 (0.0016)	Xent 2.8259 (4.4582)	Htri 0.5885 (0.3227)	Acc 31.25 (11.66)	
Epoch: [1][540/590]	Time 0.285 (0.296)	Data 0.0002 (0.0016)	Xent 2.8766 (4.4306)	Htri 0.1509 (0.3203)	Acc 34.38 (11.95)	
Epoch: [1][550/590]	Time 0.280 (0.296)	Data 0.0002 (0.0016)	Xent 2.7875 (4.4048)	Htri 0.1515 (0.3198)	Acc 25.00 (12.23)	
Epoch: [1][560/590]	Time 0.280 (0.296)	Data 0.0003 (0.0015)	Xent 3.2417 (4.3826)	Htri 0.1587 (0.3194)	Acc 23.44 (12.41)	
Epoch: [1][570/590]	Time 0.281 (0.296)	Data 0.0002 (0.0015)	Xent 3.2328 (4.3585)	Htri 0.1357 (0.3181)	Acc 28.12 (12.69)	
Epoch: [1][580/590]	Time 0.279 (0.295)	Data 0.0001 (0.0015)	Xent 3.0495 (4.3328)	Htri 0.0907 (0.3156)	Acc 20.31 (12.96)	
Epoch: [1][590/590]	Time 0.279 (0.295)	Data 0.0001 (0.0015)	Xent 2.7240 (4.3075)	Htri 0.1973 (0.3148)	Acc 37.50 (13.21)	
=> Test
Evaluating veri ...
Extracted features for query set, obtained 1678-by-2048 matrix
Extracted features for gallery set, obtained 11579-by-2048 matrix
=> BatchTime(s)/BatchSize(img): 0.025/100
Computing CMC and mAP
Results ----------
mAP: 27.1%
CMC curve
Rank-1  : 48.2%
Rank-5  : 68.7%
Rank-10 : 77.0%
Rank-20 : 85.1%
------------------
Checkpoint saved to "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-01.ckpt"
Epoch: [2][10/590]	Time 0.278 (0.368)	Data 0.0002 (0.0862)	Xent 3.2040 (2.8447)	Htri 0.2694 (0.2890)	Acc 18.75 (30.47)	
Epoch: [2][20/590]	Time 0.278 (0.323)	Data 0.0002 (0.0432)	Xent 3.3831 (2.8747)	Htri 0.3041 (0.2522)	Acc 17.19 (29.77)	
Epoch: [2][30/590]	Time 0.279 (0.308)	Data 0.0002 (0.0289)	Xent 2.8285 (2.8686)	Htri 0.0039 (0.2136)	Acc 26.56 (29.74)	
Epoch: [2][40/590]	Time 0.279 (0.301)	Data 0.0002 (0.0217)	Xent 2.8825 (2.8495)	Htri 0.4926 (0.2042)	Acc 32.81 (29.69)	
Epoch: [2][50/590]	Time 0.279 (0.296)	Data 0.0002 (0.0174)	Xent 2.4511 (2.8157)	Htri 0.0509 (0.2099)	Acc 37.50 (30.44)	
Epoch: [2][60/590]	Time 0.279 (0.294)	Data 0.0004 (0.0146)	Xent 2.8536 (2.8078)	Htri 0.0365 (0.2024)	Acc 29.69 (30.65)	
Epoch: [2][70/590]	Time 0.279 (0.291)	Data 0.0002 (0.0125)	Xent 2.6850 (2.7944)	Htri 0.0355 (0.2168)	Acc 37.50 (30.85)	
Epoch: [2][80/590]	Time 0.279 (0.290)	Data 0.0002 (0.0110)	Xent 2.5506 (2.7638)	Htri 0.2015 (0.2069)	Acc 31.25 (31.60)	
Epoch: [2][90/590]	Time 0.278 (0.289)	Data 0.0002 (0.0098)	Xent 2.5228 (2.7507)	Htri 0.1350 (0.2077)	Acc 32.81 (31.75)	
Epoch: [2][100/590]	Time 0.276 (0.288)	Data 0.0002 (0.0088)	Xent 2.6084 (2.7245)	Htri 0.3224 (0.2108)	Acc 32.81 (32.28)	
Epoch: [2][110/590]	Time 0.277 (0.287)	Data 0.0002 (0.0080)	Xent 2.6068 (2.7047)	Htri 0.1929 (0.2117)	Acc 34.38 (32.73)	
Epoch: [2][120/590]	Time 0.276 (0.286)	Data 0.0002 (0.0074)	Xent 2.7615 (2.7013)	Htri 0.0454 (0.2114)	Acc 23.44 (32.72)	
Epoch: [2][130/590]	Time 0.276 (0.285)	Data 0.0002 (0.0068)	Xent 2.4980 (2.6909)	Htri 0.5881 (0.2162)	Acc 40.62 (32.90)	
Epoch: [2][140/590]	Time 0.276 (0.285)	Data 0.0002 (0.0064)	Xent 2.1526 (2.6701)	Htri 0.1782 (0.2161)	Acc 43.75 (33.36)	
Epoch: [2][150/590]	Time 0.278 (0.284)	Data 0.0002 (0.0060)	Xent 2.2287 (2.6563)	Htri 0.1247 (0.2207)	Acc 40.62 (33.57)	
Epoch: [2][160/590]	Time 0.277 (0.284)	Data 0.0002 (0.0056)	Xent 2.3498 (2.6422)	Htri 0.1648 (0.2240)	Acc 37.50 (33.92)	
Epoch: [2][170/590]	Time 0.279 (0.283)	Data 0.0003 (0.0053)	Xent 2.5444 (2.6291)	Htri 0.1387 (0.2260)	Acc 32.81 (34.17)	
Epoch: [2][180/590]	Time 0.277 (0.283)	Data 0.0002 (0.0050)	Xent 2.6078 (2.6132)	Htri 0.0000 (0.2227)	Acc 31.25 (34.41)	
Epoch: [2][190/590]	Time 0.278 (0.283)	Data 0.0001 (0.0047)	Xent 2.3187 (2.5996)	Htri 0.1536 (0.2218)	Acc 35.94 (34.71)	
Epoch: [2][200/590]	Time 0.279 (0.282)	Data 0.0002 (0.0045)	Xent 2.5095 (2.5820)	Htri 0.1676 (0.2208)	Acc 35.94 (35.10)	
Epoch: [2][210/590]	Time 0.280 (0.282)	Data 0.0002 (0.0043)	Xent 2.2320 (2.5745)	Htri 0.2888 (0.2254)	Acc 40.62 (35.30)	
Epoch: [2][220/590]	Time 0.279 (0.282)	Data 0.0002 (0.0041)	Xent 1.9303 (2.5571)	Htri 0.4024 (0.2276)	Acc 48.44 (35.67)	
Epoch: [2][230/590]	Time 0.281 (0.282)	Data 0.0002 (0.0040)	Xent 2.3320 (2.5483)	Htri 0.1623 (0.2246)	Acc 40.62 (35.98)	
Epoch: [2][240/590]	Time 0.279 (0.282)	Data 0.0001 (0.0038)	Xent 2.2774 (2.5356)	Htri 0.2320 (0.2249)	Acc 40.62 (36.20)	
Epoch: [2][250/590]	Time 0.281 (0.282)	Data 0.0002 (0.0037)	Xent 2.0768 (2.5194)	Htri 0.3780 (0.2243)	Acc 46.88 (36.49)	
Epoch: [2][260/590]	Time 0.279 (0.282)	Data 0.0002 (0.0035)	Xent 2.1558 (2.5048)	Htri 0.0560 (0.2209)	Acc 46.88 (36.79)	
Epoch: [2][270/590]	Time 0.280 (0.282)	Data 0.0002 (0.0034)	Xent 2.0946 (2.4920)	Htri 0.0027 (0.2197)	Acc 42.19 (37.00)	
Epoch: [2][280/590]	Time 0.279 (0.282)	Data 0.0002 (0.0033)	Xent 2.3912 (2.4779)	Htri 0.4719 (0.2204)	Acc 40.62 (37.36)	
Epoch: [2][290/590]	Time 0.279 (0.282)	Data 0.0002 (0.0032)	Xent 1.9254 (2.4632)	Htri 0.1184 (0.2200)	Acc 48.44 (37.60)	
Epoch: [2][300/590]	Time 0.278 (0.281)	Data 0.0002 (0.0031)	Xent 1.9377 (2.4505)	Htri 0.0000 (0.2152)	Acc 53.12 (37.89)	
Epoch: [2][310/590]	Time 0.279 (0.281)	Data 0.0002 (0.0030)	Xent 1.9884 (2.4346)	Htri 0.0000 (0.2159)	Acc 46.88 (38.21)	
Epoch: [2][320/590]	Time 0.279 (0.281)	Data 0.0002 (0.0029)	Xent 2.2924 (2.4230)	Htri 0.0000 (0.2147)	Acc 35.94 (38.46)	
Epoch: [2][330/590]	Time 0.279 (0.281)	Data 0.0002 (0.0028)	Xent 1.7416 (2.4131)	Htri 0.0000 (0.2149)	Acc 53.12 (38.62)	
Epoch: [2][340/590]	Time 0.279 (0.281)	Data 0.0002 (0.0027)	Xent 2.1978 (2.4000)	Htri 0.0000 (0.2129)	Acc 45.31 (38.91)	
Epoch: [2][350/590]	Time 0.278 (0.281)	Data 0.0002 (0.0027)	Xent 1.8269 (2.3846)	Htri 0.1452 (0.2122)	Acc 50.00 (39.24)	
Epoch: [2][360/590]	Time 0.280 (0.281)	Data 0.0003 (0.0026)	Xent 1.8242 (2.3743)	Htri 0.0144 (0.2093)	Acc 53.12 (39.47)	
Epoch: [2][370/590]	Time 0.280 (0.281)	Data 0.0002 (0.0025)	Xent 1.8094 (2.3602)	Htri 0.2066 (0.2061)	Acc 45.31 (39.76)	
Epoch: [2][380/590]	Time 0.280 (0.281)	Data 0.0002 (0.0025)	Xent 1.9333 (2.3485)	Htri 0.2139 (0.2060)	Acc 51.56 (40.02)	
Epoch: [2][390/590]	Time 0.279 (0.281)	Data 0.0002 (0.0024)	Xent 1.7121 (2.3354)	Htri 0.4535 (0.2045)	Acc 53.12 (40.32)	
Epoch: [2][400/590]	Time 0.280 (0.281)	Data 0.0003 (0.0024)	Xent 2.0863 (2.3232)	Htri 0.4683 (0.2041)	Acc 35.94 (40.56)	
Epoch: [2][410/590]	Time 0.281 (0.281)	Data 0.0003 (0.0023)	Xent 1.7967 (2.3131)	Htri 0.0703 (0.2048)	Acc 51.56 (40.76)	
Epoch: [2][420/590]	Time 0.279 (0.281)	Data 0.0002 (0.0023)	Xent 1.6802 (2.3035)	Htri 0.0000 (0.2031)	Acc 50.00 (40.99)	
Epoch: [2][430/590]	Time 0.280 (0.281)	Data 0.0002 (0.0022)	Xent 1.6357 (2.2940)	Htri 0.0594 (0.2034)	Acc 59.38 (41.11)	
Epoch: [2][440/590]	Time 0.279 (0.281)	Data 0.0002 (0.0022)	Xent 1.5825 (2.2829)	Htri 0.1041 (0.2016)	Acc 60.94 (41.36)	
Epoch: [2][450/590]	Time 0.280 (0.281)	Data 0.0002 (0.0021)	Xent 1.8864 (2.2722)	Htri 0.1004 (0.2003)	Acc 46.88 (41.61)	
Epoch: [2][460/590]	Time 0.280 (0.281)	Data 0.0002 (0.0021)	Xent 1.8675 (2.2605)	Htri 0.1053 (0.1977)	Acc 39.06 (41.87)	
Epoch: [2][470/590]	Time 0.280 (0.281)	Data 0.0003 (0.0021)	Xent 1.8150 (2.2506)	Htri 0.0551 (0.1968)	Acc 46.88 (42.08)	
Epoch: [2][480/590]	Time 0.280 (0.281)	Data 0.0002 (0.0020)	Xent 1.5246 (2.2377)	Htri 0.2097 (0.1951)	Acc 59.38 (42.35)	
Epoch: [2][490/590]	Time 0.280 (0.281)	Data 0.0002 (0.0020)	Xent 1.4877 (2.2257)	Htri 0.0174 (0.1950)	Acc 56.25 (42.61)	
Epoch: [2][500/590]	Time 0.280 (0.281)	Data 0.0002 (0.0019)	Xent 2.1406 (2.2140)	Htri 0.1407 (0.1932)	Acc 34.38 (42.84)	
Epoch: [2][510/590]	Time 0.280 (0.281)	Data 0.0001 (0.0019)	Xent 1.5668 (2.2019)	Htri 0.0000 (0.1913)	Acc 62.50 (43.15)	
Epoch: [2][520/590]	Time 0.281 (0.281)	Data 0.0002 (0.0019)	Xent 1.5157 (2.1893)	Htri 0.1274 (0.1912)	Acc 56.25 (43.42)	
Epoch: [2][530/590]	Time 0.280 (0.281)	Data 0.0002 (0.0018)	Xent 1.7942 (2.1800)	Htri 0.5181 (0.1906)	Acc 53.12 (43.62)	
Epoch: [2][540/590]	Time 0.280 (0.281)	Data 0.0002 (0.0018)	Xent 1.6685 (2.1687)	Htri 0.0533 (0.1893)	Acc 54.69 (43.87)	
Epoch: [2][550/590]	Time 0.285 (0.281)	Data 0.0002 (0.0018)	Xent 1.6956 (2.1585)	Htri 0.0443 (0.1886)	Acc 46.88 (44.06)	
Epoch: [2][560/590]	Time 0.287 (0.281)	Data 0.0002 (0.0018)	Xent 1.5169 (2.1479)	Htri 0.0000 (0.1882)	Acc 57.81 (44.29)	
Epoch: [2][570/590]	Time 0.281 (0.281)	Data 0.0002 (0.0017)	Xent 1.2610 (2.1343)	Htri 0.1642 (0.1866)	Acc 67.19 (44.63)	
Epoch: [2][580/590]	Time 0.279 (0.281)	Data 0.0001 (0.0017)	Xent 1.2353 (2.1235)	Htri 0.0000 (0.1853)	Acc 67.19 (44.89)	
Epoch: [2][590/590]	Time 0.279 (0.281)	Data 0.0001 (0.0017)	Xent 1.5661 (2.1121)	Htri 0.0191 (0.1835)	Acc 59.38 (45.15)	
=> Test
Evaluating veri ...
Extracted features for query set, obtained 1678-by-2048 matrix
Extracted features for gallery set, obtained 11579-by-2048 matrix
=> BatchTime(s)/BatchSize(img): 0.008/100
Computing CMC and mAP
Results ----------
mAP: 39.2%
CMC curve
Rank-1  : 67.8%
Rank-5  : 83.7%
Rank-10 : 89.3%
Rank-20 : 93.0%
------------------
Checkpoint saved to "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-02.ckpt"
Epoch: [3][10/590]	Time 0.279 (0.368)	Data 0.0002 (0.0840)	Xent 1.2405 (1.3682)	Htri 0.0000 (0.0881)	Acc 70.31 (60.62)	
Epoch: [3][20/590]	Time 0.278 (0.323)	Data 0.0002 (0.0421)	Xent 1.1420 (1.2983)	Htri 0.0061 (0.0713)	Acc 71.88 (64.14)	
Epoch: [3][30/590]	Time 0.279 (0.309)	Data 0.0002 (0.0281)	Xent 1.1612 (1.2793)	Htri 0.0000 (0.0897)	Acc 68.75 (64.64)	
Epoch: [3][40/590]	Time 0.279 (0.301)	Data 0.0002 (0.0212)	Xent 1.2637 (1.2892)	Htri 0.1571 (0.1064)	Acc 70.31 (64.53)	
Epoch: [3][50/590]	Time 0.281 (0.297)	Data 0.0003 (0.0170)	Xent 1.3030 (1.2890)	Htri 0.2456 (0.1121)	Acc 64.06 (64.31)	
Epoch: [3][60/590]	Time 0.282 (0.294)	Data 0.0006 (0.0142)	Xent 1.3073 (1.2997)	Htri 0.0000 (0.1111)	Acc 65.62 (64.17)	
Epoch: [3][70/590]	Time 0.281 (0.292)	Data 0.0003 (0.0122)	Xent 1.2319 (1.2983)	Htri 0.0001 (0.1128)	Acc 67.19 (64.33)	
Epoch: [3][80/590]	Time 0.280 (0.291)	Data 0.0003 (0.0107)	Xent 1.3312 (1.2980)	Htri 0.0851 (0.1145)	Acc 65.62 (64.47)	
Epoch: [3][90/590]	Time 0.280 (0.290)	Data 0.0003 (0.0096)	Xent 1.2123 (1.2908)	Htri 0.1921 (0.1165)	Acc 65.62 (64.65)	
Epoch: [3][100/590]	Time 0.281 (0.289)	Data 0.0003 (0.0086)	Xent 1.3913 (1.2916)	Htri 0.2551 (0.1165)	Acc 67.19 (64.59)	
Epoch: [3][110/590]	Time 0.282 (0.288)	Data 0.0003 (0.0079)	Xent 1.2600 (1.2922)	Htri 0.2754 (0.1170)	Acc 67.19 (64.55)	
Epoch: [3][120/590]	Time 0.281 (0.287)	Data 0.0003 (0.0073)	Xent 1.2137 (1.2976)	Htri 0.2245 (0.1204)	Acc 67.19 (64.41)	
Epoch: [3][130/590]	Time 0.280 (0.287)	Data 0.0002 (0.0067)	Xent 1.3626 (1.2995)	Htri 0.3275 (0.1154)	Acc 60.94 (64.44)	
Epoch: [3][140/590]	Time 0.280 (0.286)	Data 0.0002 (0.0062)	Xent 1.1829 (1.2983)	Htri 0.0000 (0.1153)	Acc 75.00 (64.49)	
Epoch: [3][150/590]	Time 0.280 (0.286)	Data 0.0003 (0.0058)	Xent 1.0645 (1.2962)	Htri 0.0309 (0.1134)	Acc 70.31 (64.47)	
Epoch: [3][160/590]	Time 0.280 (0.286)	Data 0.0002 (0.0055)	Xent 1.1015 (1.2934)	Htri 0.0000 (0.1132)	Acc 64.06 (64.44)	
Epoch: [3][170/590]	Time 0.280 (0.285)	Data 0.0002 (0.0052)	Xent 1.2934 (1.2954)	Htri 0.0000 (0.1116)	Acc 60.94 (64.38)	
Epoch: [3][180/590]	Time 0.280 (0.285)	Data 0.0002 (0.0049)	Xent 1.0547 (1.2895)	Htri 0.1492 (0.1150)	Acc 70.31 (64.51)	
Epoch: [3][190/590]	Time 0.280 (0.285)	Data 0.0002 (0.0047)	Xent 1.0387 (1.2806)	Htri 0.1866 (0.1131)	Acc 68.75 (64.71)	
Epoch: [3][200/590]	Time 0.280 (0.284)	Data 0.0002 (0.0044)	Xent 1.0185 (1.2730)	Htri 0.0709 (0.1101)	Acc 73.44 (64.88)	
Epoch: [3][210/590]	Time 0.280 (0.284)	Data 0.0002 (0.0042)	Xent 1.0772 (1.2596)	Htri 0.2239 (0.1115)	Acc 73.44 (65.36)	
Epoch: [3][220/590]	Time 0.280 (0.284)	Data 0.0002 (0.0041)	Xent 1.2131 (1.2559)	Htri 0.0850 (0.1113)	Acc 70.31 (65.45)	
Epoch: [3][230/590]	Time 0.280 (0.284)	Data 0.0002 (0.0039)	Xent 1.2181 (1.2517)	Htri 0.1735 (0.1134)	Acc 56.25 (65.45)	
Epoch: [3][240/590]	Time 0.280 (0.284)	Data 0.0002 (0.0037)	Xent 1.2948 (1.2479)	Htri 0.0508 (0.1123)	Acc 60.94 (65.64)	
Epoch: [3][250/590]	Time 0.279 (0.283)	Data 0.0002 (0.0036)	Xent 0.9268 (1.2417)	Htri 0.0000 (0.1101)	Acc 71.88 (65.81)	
Epoch: [3][260/590]	Time 0.280 (0.283)	Data 0.0002 (0.0035)	Xent 1.0599 (1.2398)	Htri 0.0000 (0.1116)	Acc 71.88 (65.87)	
Epoch: [3][270/590]	Time 0.280 (0.283)	Data 0.0002 (0.0033)	Xent 1.0784 (1.2362)	Htri 0.0000 (0.1124)	Acc 65.62 (65.98)	
Epoch: [3][280/590]	Time 0.280 (0.283)	Data 0.0002 (0.0032)	Xent 1.1752 (1.2304)	Htri 0.0224 (0.1119)	Acc 70.31 (66.18)	
Epoch: [3][290/590]	Time 0.281 (0.283)	Data 0.0003 (0.0031)	Xent 0.9589 (1.2271)	Htri 0.0000 (0.1091)	Acc 75.00 (66.20)	
Epoch: [3][300/590]	Time 0.281 (0.283)	Data 0.0003 (0.0030)	Xent 0.9251 (1.2230)	Htri 0.1414 (0.1084)	Acc 70.31 (66.21)	
Epoch: [3][310/590]	Time 0.281 (0.283)	Data 0.0004 (0.0030)	Xent 1.2741 (1.2166)	Htri 0.2342 (0.1094)	Acc 65.62 (66.42)	
Epoch: [3][320/590]	Time 0.280 (0.283)	Data 0.0003 (0.0029)	Xent 1.1814 (1.2132)	Htri 0.0897 (0.1082)	Acc 65.62 (66.49)	
Epoch: [3][330/590]	Time 0.281 (0.283)	Data 0.0004 (0.0028)	Xent 1.0205 (1.2075)	Htri 0.0096 (0.1073)	Acc 64.06 (66.63)	
Epoch: [3][340/590]	Time 0.282 (0.283)	Data 0.0003 (0.0027)	Xent 0.9855 (1.2022)	Htri 0.0976 (0.1076)	Acc 78.12 (66.78)	
Epoch: [3][350/590]	Time 0.281 (0.283)	Data 0.0003 (0.0026)	Xent 1.0553 (1.1996)	Htri 0.1198 (0.1059)	Acc 70.31 (66.84)	
Epoch: [3][360/590]	Time 0.280 (0.283)	Data 0.0003 (0.0026)	Xent 0.8574 (1.1940)	Htri 0.0804 (0.1056)	Acc 75.00 (67.02)	
Epoch: [3][370/590]	Time 0.281 (0.283)	Data 0.0003 (0.0025)	Xent 1.0882 (1.1903)	Htri 0.3587 (0.1050)	Acc 70.31 (67.09)	
Epoch: [3][380/590]	Time 0.280 (0.283)	Data 0.0003 (0.0025)	Xent 1.0732 (1.1866)	Htri 0.2424 (0.1052)	Acc 76.56 (67.20)	
Epoch: [3][390/590]	Time 0.279 (0.282)	Data 0.0002 (0.0024)	Xent 1.1976 (1.1816)	Htri 0.1583 (0.1066)	Acc 62.50 (67.28)	
Epoch: [3][400/590]	Time 0.279 (0.282)	Data 0.0002 (0.0023)	Xent 0.9895 (1.1784)	Htri 0.0132 (0.1075)	Acc 71.88 (67.34)	
Epoch: [3][410/590]	Time 0.282 (0.282)	Data 0.0002 (0.0023)	Xent 1.2235 (1.1757)	Htri 0.0540 (0.1067)	Acc 67.19 (67.38)	
Epoch: [3][420/590]	Time 0.285 (0.282)	Data 0.0003 (0.0022)	Xent 1.0929 (1.1717)	Htri 0.1796 (0.1067)	Acc 67.19 (67.52)	
Epoch: [3][430/590]	Time 0.286 (0.282)	Data 0.0002 (0.0022)	Xent 1.1057 (1.1697)	Htri 0.0000 (0.1078)	Acc 75.00 (67.55)	
Epoch: [3][440/590]	Time 0.284 (0.283)	Data 0.0003 (0.0022)	Xent 1.1193 (1.1662)	Htri 0.0000 (0.1065)	Acc 65.62 (67.64)	
Epoch: [3][450/590]	Time 0.279 (0.282)	Data 0.0002 (0.0021)	Xent 1.0090 (1.1616)	Htri 0.0000 (0.1056)	Acc 75.00 (67.80)	
Epoch: [3][460/590]	Time 0.280 (0.282)	Data 0.0003 (0.0021)	Xent 0.9032 (1.1566)	Htri 0.0236 (0.1041)	Acc 76.56 (67.93)	
Epoch: [3][470/590]	Time 0.280 (0.282)	Data 0.0002 (0.0020)	Xent 0.9060 (1.1509)	Htri 0.0000 (0.1047)	Acc 68.75 (68.10)	
Epoch: [3][480/590]	Time 0.280 (0.282)	Data 0.0002 (0.0020)	Xent 0.9603 (1.1455)	Htri 0.0000 (0.1041)	Acc 64.06 (68.26)	
Epoch: [3][490/590]	Time 0.280 (0.282)	Data 0.0001 (0.0020)	Xent 1.0408 (1.1424)	Htri 0.0000 (0.1036)	Acc 70.31 (68.35)	
Epoch: [3][500/590]	Time 0.280 (0.282)	Data 0.0002 (0.0019)	Xent 0.8586 (1.1402)	Htri 0.0000 (0.1032)	Acc 75.00 (68.38)	
Epoch: [3][510/590]	Time 0.280 (0.282)	Data 0.0002 (0.0019)	Xent 0.9440 (1.1367)	Htri 0.0606 (0.1027)	Acc 70.31 (68.46)	
Epoch: [3][520/590]	Time 0.280 (0.282)	Data 0.0002 (0.0019)	Xent 0.6825 (1.1329)	Htri 0.0057 (0.1019)	Acc 84.38 (68.57)	
Epoch: [3][530/590]	Time 0.280 (0.282)	Data 0.0002 (0.0018)	Xent 0.8995 (1.1279)	Htri 0.0000 (0.1013)	Acc 71.88 (68.72)	
Epoch: [3][540/590]	Time 0.279 (0.282)	Data 0.0002 (0.0018)	Xent 0.7346 (1.1236)	Htri 0.0000 (0.1014)	Acc 79.69 (68.84)	
Epoch: [3][550/590]	Time 0.282 (0.282)	Data 0.0003 (0.0018)	Xent 1.1935 (1.1200)	Htri 0.0885 (0.1015)	Acc 65.62 (68.94)	
Epoch: [3][560/590]	Time 0.281 (0.282)	Data 0.0002 (0.0017)	Xent 0.8805 (1.1170)	Htri 0.0000 (0.1014)	Acc 76.56 (69.04)	
Epoch: [3][570/590]	Time 0.281 (0.282)	Data 0.0002 (0.0017)	Xent 0.8435 (1.1136)	Htri 0.0267 (0.1009)	Acc 76.56 (69.15)	
Epoch: [3][580/590]	Time 0.277 (0.282)	Data 0.0001 (0.0017)	Xent 0.9810 (1.1104)	Htri 0.1846 (0.1005)	Acc 76.56 (69.21)	
Epoch: [3][590/590]	Time 0.276 (0.282)	Data 0.0001 (0.0017)	Xent 0.8001 (1.1076)	Htri 0.0526 (0.1004)	Acc 73.44 (69.29)	
=> Test
Evaluating veri ...
Extracted features for query set, obtained 1678-by-2048 matrix
Extracted features for gallery set, obtained 11579-by-2048 matrix
=> BatchTime(s)/BatchSize(img): 0.008/100
Computing CMC and mAP
Results ----------
mAP: 44.1%
CMC curve
Rank-1  : 74.2%
Rank-5  : 86.9%
Rank-10 : 91.9%
Rank-20 : 95.3%
------------------
Checkpoint saved to "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-03.ckpt"
Epoch: [4][10/590]	Time 0.278 (0.375)	Data 0.0002 (0.0942)	Xent 0.9548 (0.8103)	Htri 0.2617 (0.0824)	Acc 78.12 (75.94)	
Epoch: [4][20/590]	Time 0.284 (0.327)	Data 0.0002 (0.0472)	Xent 0.9754 (0.8418)	Htri 0.1610 (0.0941)	Acc 70.31 (75.94)	
Epoch: [4][30/590]	Time 0.278 (0.310)	Data 0.0002 (0.0315)	Xent 0.9764 (0.8531)	Htri 0.4474 (0.1102)	Acc 70.31 (76.09)	
Epoch: [4][40/590]	Time 0.278 (0.302)	Data 0.0002 (0.0237)	Xent 0.8854 (0.8709)	Htri 0.2134 (0.1101)	Acc 78.12 (75.94)	
Epoch: [4][50/590]	Time 0.279 (0.297)	Data 0.0002 (0.0190)	Xent 0.9380 (0.8757)	Htri 0.0329 (0.1058)	Acc 68.75 (75.34)	
Epoch: [4][60/590]	Time 0.280 (0.294)	Data 0.0004 (0.0159)	Xent 0.7510 (0.8534)	Htri 0.1108 (0.0977)	Acc 84.38 (76.30)	
Epoch: [4][70/590]	Time 0.278 (0.292)	Data 0.0002 (0.0136)	Xent 0.7500 (0.8426)	Htri 0.0226 (0.0989)	Acc 82.81 (76.72)	
Epoch: [4][80/590]	Time 0.278 (0.290)	Data 0.0002 (0.0120)	Xent 0.9011 (0.8387)	Htri 0.1575 (0.0976)	Acc 76.56 (76.99)	
Epoch: [4][90/590]	Time 0.278 (0.289)	Data 0.0002 (0.0107)	Xent 0.8396 (0.8391)	Htri 0.0801 (0.0985)	Acc 71.88 (76.96)	
Epoch: [4][100/590]	Time 0.278 (0.288)	Data 0.0002 (0.0096)	Xent 0.7325 (0.8329)	Htri 0.0998 (0.0923)	Acc 76.56 (76.95)	
Epoch: [4][110/590]	Time 0.279 (0.287)	Data 0.0002 (0.0088)	Xent 0.8189 (0.8285)	Htri 0.0000 (0.0938)	Acc 75.00 (76.95)	
Epoch: [4][120/590]	Time 0.278 (0.286)	Data 0.0002 (0.0081)	Xent 0.8960 (0.8263)	Htri 0.0000 (0.0905)	Acc 71.88 (76.98)	
Epoch: [4][130/590]	Time 0.279 (0.286)	Data 0.0002 (0.0075)	Xent 0.7022 (0.8213)	Htri 0.0000 (0.0852)	Acc 81.25 (77.09)	
Epoch: [4][140/590]	Time 0.280 (0.285)	Data 0.0003 (0.0069)	Xent 0.7934 (0.8135)	Htri 0.1550 (0.0836)	Acc 76.56 (77.28)	
Epoch: [4][150/590]	Time 0.285 (0.285)	Data 0.0002 (0.0065)	Xent 0.8082 (0.8100)	Htri 0.4061 (0.0864)	Acc 79.69 (77.39)	
Epoch: [4][160/590]	Time 0.285 (0.285)	Data 0.0002 (0.0061)	Xent 0.8264 (0.8061)	Htri 0.2120 (0.0855)	Acc 82.81 (77.53)	
Epoch: [4][170/590]	Time 0.287 (0.285)	Data 0.0002 (0.0058)	Xent 0.9180 (0.8061)	Htri 0.0069 (0.0839)	Acc 68.75 (77.47)	
Epoch: [4][180/590]	Time 0.288 (0.285)	Data 0.0003 (0.0055)	Xent 0.7342 (0.8034)	Htri 0.0000 (0.0836)	Acc 76.56 (77.56)	
Epoch: [4][190/590]	Time 0.285 (0.285)	Data 0.0002 (0.0052)	Xent 0.4641 (0.7976)	Htri 0.0299 (0.0826)	Acc 90.62 (77.72)	
Epoch: [4][200/590]	Time 0.285 (0.285)	Data 0.0001 (0.0049)	Xent 0.4072 (0.7894)	Htri 0.0000 (0.0794)	Acc 92.19 (78.02)	
Epoch: [4][210/590]	Time 0.287 (0.285)	Data 0.0002 (0.0047)	Xent 0.6377 (0.7844)	Htri 0.0000 (0.0786)	Acc 85.94 (78.16)	
Epoch: [4][220/590]	Time 0.285 (0.285)	Data 0.0003 (0.0045)	Xent 0.7343 (0.7811)	Htri 0.0137 (0.0770)	Acc 76.56 (78.24)	
Epoch: [4][230/590]	Time 0.286 (0.285)	Data 0.0003 (0.0043)	Xent 0.9059 (0.7781)	Htri 0.1864 (0.0763)	Acc 73.44 (78.30)	
Epoch: [4][240/590]	Time 0.285 (0.285)	Data 0.0001 (0.0041)	Xent 0.6853 (0.7762)	Htri 0.0331 (0.0742)	Acc 82.81 (78.35)	
Epoch: [4][250/590]	Time 0.283 (0.285)	Data 0.0002 (0.0040)	Xent 0.5638 (0.7727)	Htri 0.0494 (0.0731)	Acc 81.25 (78.42)	
Epoch: [4][260/590]	Time 0.284 (0.285)	Data 0.0003 (0.0038)	Xent 0.7177 (0.7683)	Htri 0.1198 (0.0736)	Acc 76.56 (78.50)	
Epoch: [4][270/590]	Time 0.285 (0.285)	Data 0.0002 (0.0037)	Xent 0.7395 (0.7630)	Htri 0.0022 (0.0719)	Acc 73.44 (78.63)	
Epoch: [4][280/590]	Time 0.286 (0.285)	Data 0.0002 (0.0036)	Xent 0.6740 (0.7577)	Htri 0.1207 (0.0719)	Acc 75.00 (78.76)	
Epoch: [4][290/590]	Time 0.285 (0.285)	Data 0.0002 (0.0035)	Xent 0.8395 (0.7555)	Htri 0.0510 (0.0711)	Acc 75.00 (78.77)	
Epoch: [4][300/590]	Time 0.287 (0.285)	Data 0.0001 (0.0034)	Xent 0.7806 (0.7533)	Htri 0.1430 (0.0707)	Acc 75.00 (78.79)	
Epoch: [4][310/590]	Time 0.284 (0.285)	Data 0.0002 (0.0033)	Xent 0.7490 (0.7502)	Htri 0.0000 (0.0698)	Acc 79.69 (78.82)	
Epoch: [4][320/590]	Time 0.285 (0.285)	Data 0.0002 (0.0032)	Xent 0.7796 (0.7492)	Htri 0.0000 (0.0693)	Acc 70.31 (78.83)	
Epoch: [4][330/590]	Time 0.286 (0.285)	Data 0.0003 (0.0031)	Xent 0.5765 (0.7475)	Htri 0.1591 (0.0700)	Acc 84.38 (78.86)	
Epoch: [4][340/590]	Time 0.287 (0.285)	Data 0.0003 (0.0030)	Xent 0.4536 (0.7444)	Htri 0.0000 (0.0701)	Acc 87.50 (78.91)	
Epoch: [4][350/590]	Time 0.281 (0.285)	Data 0.0002 (0.0029)	Xent 0.6497 (0.7420)	Htri 0.0897 (0.0685)	Acc 84.38 (78.99)	
Epoch: [4][360/590]	Time 0.280 (0.285)	Data 0.0002 (0.0028)	Xent 0.7135 (0.7391)	Htri 0.0204 (0.0683)	Acc 81.25 (79.08)	
Epoch: [4][370/590]	Time 0.280 (0.285)	Data 0.0002 (0.0028)	Xent 0.7641 (0.7364)	Htri 0.0971 (0.0677)	Acc 79.69 (79.19)	
Epoch: [4][380/590]	Time 0.282 (0.285)	Data 0.0003 (0.0027)	Xent 0.8416 (0.7341)	Htri 0.1608 (0.0669)	Acc 73.44 (79.25)	
Epoch: [4][390/590]	Time 0.280 (0.284)	Data 0.0001 (0.0026)	Xent 0.6788 (0.7317)	Htri 0.0000 (0.0673)	Acc 76.56 (79.28)	
Epoch: [4][400/590]	Time 0.287 (0.284)	Data 0.0002 (0.0026)	Xent 0.6552 (0.7289)	Htri 0.0355 (0.0675)	Acc 76.56 (79.39)	
Epoch: [4][410/590]	Time 0.287 (0.284)	Data 0.0002 (0.0025)	Xent 0.5598 (0.7266)	Htri 0.0000 (0.0666)	Acc 89.06 (79.47)	
Epoch: [4][420/590]	Time 0.285 (0.284)	Data 0.0001 (0.0025)	Xent 0.7545 (0.7228)	Htri 0.0624 (0.0661)	Acc 71.88 (79.57)	
Epoch: [4][430/590]	Time 0.288 (0.284)	Data 0.0002 (0.0024)	Xent 0.7504 (0.7214)	Htri 0.0180 (0.0661)	Acc 75.00 (79.59)	
Epoch: [4][440/590]	Time 0.283 (0.284)	Data 0.0002 (0.0024)	Xent 0.7650 (0.7194)	Htri 0.0927 (0.0658)	Acc 79.69 (79.62)	
Epoch: [4][450/590]	Time 0.286 (0.284)	Data 0.0002 (0.0023)	Xent 0.8280 (0.7172)	Htri 0.1597 (0.0657)	Acc 78.12 (79.70)	
Epoch: [4][460/590]	Time 0.285 (0.284)	Data 0.0002 (0.0023)	Xent 0.5611 (0.7155)	Htri 0.0636 (0.0657)	Acc 84.38 (79.75)	
Epoch: [4][470/590]	Time 0.286 (0.284)	Data 0.0002 (0.0022)	Xent 0.7668 (0.7135)	Htri 0.0000 (0.0663)	Acc 71.88 (79.79)	
Epoch: [4][480/590]	Time 0.285 (0.284)	Data 0.0002 (0.0022)	Xent 0.7509 (0.7119)	Htri 0.0000 (0.0658)	Acc 79.69 (79.83)	
Epoch: [4][490/590]	Time 0.287 (0.284)	Data 0.0003 (0.0021)	Xent 0.5960 (0.7101)	Htri 0.0224 (0.0655)	Acc 85.94 (79.88)	
Epoch: [4][500/590]	Time 0.286 (0.285)	Data 0.0002 (0.0021)	Xent 0.6226 (0.7088)	Htri 0.0000 (0.0653)	Acc 82.81 (79.90)	
Epoch: [4][510/590]	Time 0.285 (0.285)	Data 0.0002 (0.0021)	Xent 0.6324 (0.7061)	Htri 0.0413 (0.0646)	Acc 89.06 (79.99)	
Epoch: [4][520/590]	Time 0.283 (0.285)	Data 0.0002 (0.0020)	Xent 0.6028 (0.7045)	Htri 0.0000 (0.0659)	Acc 84.38 (80.06)	
Epoch: [4][530/590]	Time 0.285 (0.285)	Data 0.0002 (0.0020)	Xent 0.5802 (0.7043)	Htri 0.0451 (0.0660)	Acc 85.94 (80.08)	
Epoch: [4][540/590]	Time 0.285 (0.285)	Data 0.0002 (0.0020)	Xent 0.6898 (0.7032)	Htri 0.0000 (0.0661)	Acc 81.25 (80.13)	
Epoch: [4][550/590]	Time 0.286 (0.285)	Data 0.0002 (0.0019)	Xent 0.6273 (0.7024)	Htri 0.0000 (0.0652)	Acc 82.81 (80.16)	
Epoch: [4][560/590]	Time 0.281 (0.285)	Data 0.0002 (0.0019)	Xent 0.6929 (0.7019)	Htri 0.1450 (0.0659)	Acc 79.69 (80.18)	
Epoch: [4][570/590]	Time 0.280 (0.284)	Data 0.0001 (0.0019)	Xent 0.5892 (0.6998)	Htri 0.0654 (0.0656)	Acc 84.38 (80.29)	
Epoch: [4][580/590]	Time 0.279 (0.284)	Data 0.0001 (0.0018)	Xent 0.5557 (0.6983)	Htri 0.0000 (0.0652)	Acc 78.12 (80.33)	
Epoch: [4][590/590]	Time 0.277 (0.284)	Data 0.0001 (0.0018)	Xent 0.6574 (0.6963)	Htri 0.0092 (0.0650)	Acc 84.38 (80.38)	
=> Test
Evaluating veri ...
Extracted features for query set, obtained 1678-by-2048 matrix
Extracted features for gallery set, obtained 11579-by-2048 matrix
=> BatchTime(s)/BatchSize(img): 0.008/100
Computing CMC and mAP
Results ----------
mAP: 47.1%
CMC curve
Rank-1  : 79.4%
Rank-5  : 89.5%
Rank-10 : 93.2%
Rank-20 : 96.1%
------------------
Checkpoint saved to "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-04.ckpt"
Elapsed 0:15:41
=> Show performance summary
veri (source)
- epoch 1	 rank1 48.2%
- epoch 2	 rank1 67.8%
- epoch 3	 rank1 74.2%
- epoch 4	 rank1 79.4%
==========
Args:Namespace(adam_beta1=0.9, adam_beta2=0.999, arch='resnet50', color_aug=False, color_jitter=False, eval_freq=1, evaluate=False, gamma=0.1, gpu_devices='0', height=224, label_smooth=False, lambda_htri=1, lambda_xent=1, load_weights='', lr=0.0003, lr_scheduler='multi_step', margin=0.3, max_epoch=4, momentum=0.9, no_pretrained=False, num_instances=4, optim='amsgrad', print_freq=10, query_remove=True, random_erase=False, resume='/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003', rmsprop_alpha=0.99, root='/mnt/fast/nobackup/users/rs01960/AdvanceCV', save_dir='/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003', seed=1, sgd_dampening=0, sgd_nesterov=False, source_names=['veri'], split_id=0, start_epoch=0, start_eval=0, stepsize=[20, 40], target_names=['veri'], test_batch_size=100, test_size=800, train_batch_size=64, train_sampler='RandomSampler', use_avai_gpus=False, use_cpu=False, visualize_ranks=False, weight_decay=0.0005, width=224, workers=8)
==========
Value Of GPU :  True
Currently using GPU 0
Initializing image data manager
=> Initializing TRAIN (source) datasets
=> VeRi loaded
Image Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   576 |    37778 |        20
  query    |   200 |     1678 |        19
  gallery  |   200 |    11579 |        19
  ----------------------------------------
=> Initializing TEST (target) datasets
=> VeRi loaded
Image Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   576 |    37778 |        20
  query    |   200 |     1678 |        19
  gallery  |   200 |    11579 |        19
  ----------------------------------------


  **************** Summary ****************
  train names      : ['veri']
  # train datasets : 1
  # train ids      : 576
  # train images   : 37778
  # train cameras  : 20
  test names       : ['veri']
  *****************************************


Initializing model: resnet50
Initialized model with pretrained weights from https://download.pytorch.org/models/resnet50-19c8e357.pth
Model size: 23.508 M
Loading checkpoint from "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-03.ckpt"
Loaded model weights
Loaded optimizer
** previous epoch = 3	 previous rank1 = 74.2%
=> Start training
Epoch: [4][10/590]	Time 0.275 (1.261)	Data 0.0002 (0.0745)	Xent 0.7859 (0.8323)	Htri 0.0000 (0.1102)	Acc 85.94 (77.19)	
Epoch: [4][20/590]	Time 0.278 (0.770)	Data 0.0002 (0.0374)	Xent 0.8300 (0.8381)	Htri 0.1883 (0.1020)	Acc 78.12 (76.72)	
Epoch: [4][30/590]	Time 0.280 (0.606)	Data 0.0003 (0.0250)	Xent 0.7834 (0.8270)	Htri 0.1082 (0.0868)	Acc 81.25 (76.93)	
Epoch: [4][40/590]	Time 0.279 (0.524)	Data 0.0003 (0.0188)	Xent 0.7287 (0.8255)	Htri 0.0505 (0.0733)	Acc 81.25 (76.99)	
Epoch: [4][50/590]	Time 0.276 (0.475)	Data 0.0003 (0.0151)	Xent 0.6634 (0.8122)	Htri 0.0000 (0.0662)	Acc 87.50 (77.31)	
Epoch: [4][60/590]	Time 0.276 (0.442)	Data 0.0003 (0.0127)	Xent 0.6992 (0.7910)	Htri 0.0251 (0.0649)	Acc 82.81 (78.07)	
Epoch: [4][70/590]	Time 0.277 (0.418)	Data 0.0003 (0.0109)	Xent 0.7908 (0.7734)	Htri 0.0004 (0.0594)	Acc 76.56 (78.71)	
Epoch: [4][80/590]	Time 0.277 (0.400)	Data 0.0002 (0.0096)	Xent 0.7104 (0.7678)	Htri 0.0997 (0.0655)	Acc 84.38 (78.61)	
Epoch: [4][90/590]	Time 0.277 (0.387)	Data 0.0003 (0.0085)	Xent 0.8555 (0.7725)	Htri 0.0556 (0.0682)	Acc 70.31 (78.51)	
Epoch: [4][100/590]	Time 0.278 (0.376)	Data 0.0003 (0.0077)	Xent 0.6611 (0.7688)	Htri 0.0476 (0.0660)	Acc 81.25 (78.70)	
Epoch: [4][110/590]	Time 0.277 (0.367)	Data 0.0002 (0.0070)	Xent 0.8131 (0.7670)	Htri 0.0034 (0.0637)	Acc 78.12 (78.78)	
Epoch: [4][120/590]	Time 0.277 (0.360)	Data 0.0003 (0.0065)	Xent 0.6881 (0.7615)	Htri 0.0000 (0.0629)	Acc 79.69 (79.00)	
Epoch: [4][130/590]	Time 0.281 (0.353)	Data 0.0003 (0.0060)	Xent 0.8303 (0.7629)	Htri 0.4331 (0.0648)	Acc 76.56 (78.92)	
Epoch: [4][140/590]	Time 0.281 (0.348)	Data 0.0004 (0.0056)	Xent 0.8498 (0.7616)	Htri 0.1991 (0.0648)	Acc 81.25 (78.96)	
Epoch: [4][150/590]	Time 0.279 (0.343)	Data 0.0003 (0.0052)	Xent 0.7309 (0.7585)	Htri 0.0000 (0.0644)	Acc 81.25 (79.07)	
Epoch: [4][160/590]	Time 0.283 (0.340)	Data 0.0004 (0.0049)	Xent 0.6782 (0.7563)	Htri 0.0983 (0.0624)	Acc 75.00 (79.15)	
Epoch: [4][170/590]	Time 0.282 (0.336)	Data 0.0003 (0.0047)	Xent 0.7266 (0.7547)	Htri 0.0000 (0.0608)	Acc 79.69 (79.15)	
Epoch: [4][180/590]	Time 0.280 (0.333)	Data 0.0004 (0.0044)	Xent 0.7580 (0.7502)	Htri 0.2142 (0.0612)	Acc 78.12 (79.31)	
Epoch: [4][190/590]	Time 0.283 (0.330)	Data 0.0004 (0.0042)	Xent 0.6570 (0.7488)	Htri 0.0789 (0.0610)	Acc 84.38 (79.27)	
Epoch: [4][200/590]	Time 0.282 (0.328)	Data 0.0003 (0.0040)	Xent 0.7407 (0.7479)	Htri 0.1843 (0.0628)	Acc 76.56 (79.23)	
Epoch: [4][210/590]	Time 0.283 (0.326)	Data 0.0002 (0.0038)	Xent 0.7800 (0.7452)	Htri 0.0089 (0.0607)	Acc 71.88 (79.35)	
Epoch: [4][220/590]	Time 0.282 (0.324)	Data 0.0005 (0.0037)	Xent 0.6938 (0.7409)	Htri 0.1471 (0.0606)	Acc 82.81 (79.45)	
Epoch: [4][230/590]	Time 0.280 (0.322)	Data 0.0003 (0.0035)	Xent 0.8888 (0.7375)	Htri 0.1546 (0.0605)	Acc 64.06 (79.50)	
Epoch: [4][240/590]	Time 0.280 (0.320)	Data 0.0002 (0.0034)	Xent 0.5638 (0.7336)	Htri 0.0056 (0.0602)	Acc 87.50 (79.65)	
Epoch: [4][250/590]	Time 0.287 (0.318)	Data 0.0003 (0.0033)	Xent 0.5477 (0.7299)	Htri 0.0033 (0.0593)	Acc 89.06 (79.79)	
Epoch: [4][260/590]	Time 0.283 (0.317)	Data 0.0003 (0.0032)	Xent 0.6613 (0.7289)	Htri 0.0000 (0.0599)	Acc 79.69 (79.77)	
Epoch: [4][270/590]	Time 0.286 (0.316)	Data 0.0002 (0.0030)	Xent 0.7856 (0.7278)	Htri 0.0434 (0.0609)	Acc 81.25 (79.82)	
Epoch: [4][280/590]	Time 0.283 (0.315)	Data 0.0002 (0.0029)	Xent 0.7361 (0.7247)	Htri 0.1077 (0.0611)	Acc 84.38 (79.92)	
Epoch: [4][290/590]	Time 0.286 (0.314)	Data 0.0003 (0.0029)	Xent 0.7379 (0.7200)	Htri 0.0113 (0.0598)	Acc 78.12 (80.06)	
Epoch: [4][300/590]	Time 0.282 (0.313)	Data 0.0003 (0.0028)	Xent 0.7066 (0.7187)	Htri 0.0073 (0.0596)	Acc 79.69 (80.08)	
Epoch: [4][310/590]	Time 0.284 (0.312)	Data 0.0003 (0.0027)	Xent 0.6634 (0.7184)	Htri 0.2442 (0.0595)	Acc 82.81 (80.08)	
Epoch: [4][320/590]	Time 0.282 (0.311)	Data 0.0002 (0.0026)	Xent 0.8299 (0.7182)	Htri 0.0913 (0.0617)	Acc 76.56 (80.08)	
Epoch: [4][330/590]	Time 0.283 (0.310)	Data 0.0006 (0.0025)	Xent 0.8482 (0.7157)	Htri 0.0253 (0.0614)	Acc 76.56 (80.18)	
Epoch: [4][340/590]	Time 0.281 (0.309)	Data 0.0002 (0.0025)	Xent 0.7385 (0.7164)	Htri 0.1337 (0.0612)	Acc 79.69 (80.08)	
Epoch: [4][350/590]	Time 0.281 (0.308)	Data 0.0001 (0.0024)	Xent 0.5081 (0.7155)	Htri 0.0556 (0.0609)	Acc 85.94 (80.08)	
Epoch: [4][360/590]	Time 0.288 (0.308)	Data 0.0002 (0.0024)	Xent 0.7559 (0.7141)	Htri 0.0000 (0.0620)	Acc 76.56 (80.13)	
Epoch: [4][370/590]	Time 0.283 (0.307)	Data 0.0003 (0.0023)	Xent 0.8578 (0.7148)	Htri 0.0274 (0.0617)	Acc 75.00 (80.07)	
Epoch: [4][380/590]	Time 0.283 (0.306)	Data 0.0002 (0.0022)	Xent 0.6353 (0.7137)	Htri 0.0000 (0.0622)	Acc 82.81 (80.09)	
Epoch: [4][390/590]	Time 0.281 (0.306)	Data 0.0003 (0.0022)	Xent 0.7056 (0.7154)	Htri 0.0000 (0.0627)	Acc 78.12 (80.00)	
Epoch: [4][400/590]	Time 0.284 (0.305)	Data 0.0003 (0.0021)	Xent 0.6684 (0.7136)	Htri 0.0000 (0.0628)	Acc 82.81 (80.04)	
Epoch: [4][410/590]	Time 0.284 (0.305)	Data 0.0003 (0.0021)	Xent 0.6314 (0.7118)	Htri 0.0498 (0.0621)	Acc 85.94 (80.08)	
Epoch: [4][420/590]	Time 0.283 (0.304)	Data 0.0003 (0.0021)	Xent 0.6944 (0.7097)	Htri 0.0779 (0.0617)	Acc 82.81 (80.19)	
Epoch: [4][430/590]	Time 0.284 (0.304)	Data 0.0004 (0.0020)	Xent 0.6353 (0.7080)	Htri 0.2498 (0.0622)	Acc 84.38 (80.23)	
Epoch: [4][440/590]	Time 0.281 (0.303)	Data 0.0003 (0.0020)	Xent 0.8145 (0.7069)	Htri 0.0306 (0.0624)	Acc 71.88 (80.26)	
Epoch: [4][450/590]	Time 0.285 (0.303)	Data 0.0004 (0.0019)	Xent 0.5686 (0.7043)	Htri 0.0500 (0.0620)	Acc 84.38 (80.32)	
Epoch: [4][460/590]	Time 0.282 (0.302)	Data 0.0003 (0.0019)	Xent 0.4435 (0.7023)	Htri 0.0000 (0.0616)	Acc 92.19 (80.37)	
Epoch: [4][470/590]	Time 0.283 (0.302)	Data 0.0003 (0.0019)	Xent 0.5649 (0.7001)	Htri 0.0070 (0.0613)	Acc 79.69 (80.37)	
Epoch: [4][480/590]	Time 0.282 (0.301)	Data 0.0002 (0.0018)	Xent 0.5589 (0.6976)	Htri 0.2184 (0.0611)	Acc 84.38 (80.45)	
Epoch: [4][490/590]	Time 0.282 (0.301)	Data 0.0003 (0.0018)	Xent 0.5348 (0.6943)	Htri 0.0268 (0.0614)	Acc 84.38 (80.53)	
Epoch: [4][500/590]	Time 0.286 (0.301)	Data 0.0003 (0.0018)	Xent 0.4796 (0.6927)	Htri 0.0000 (0.0611)	Acc 84.38 (80.56)	
Epoch: [4][510/590]	Time 0.281 (0.300)	Data 0.0002 (0.0017)	Xent 0.6245 (0.6914)	Htri 0.0332 (0.0613)	Acc 79.69 (80.57)	
Epoch: [4][520/590]	Time 0.285 (0.300)	Data 0.0003 (0.0017)	Xent 0.5238 (0.6906)	Htri 0.0000 (0.0614)	Acc 85.94 (80.60)	
Epoch: [4][530/590]	Time 0.284 (0.300)	Data 0.0003 (0.0017)	Xent 0.4643 (0.6877)	Htri 0.0098 (0.0604)	Acc 89.06 (80.68)	
Epoch: [4][540/590]	Time 0.281 (0.299)	Data 0.0002 (0.0017)	Xent 0.5837 (0.6855)	Htri 0.0979 (0.0603)	Acc 79.69 (80.71)	
Epoch: [4][550/590]	Time 0.283 (0.299)	Data 0.0001 (0.0016)	Xent 0.4508 (0.6835)	Htri 0.0419 (0.0605)	Acc 85.94 (80.80)	
Epoch: [4][560/590]	Time 0.282 (0.299)	Data 0.0002 (0.0016)	Xent 0.6534 (0.6814)	Htri 0.0154 (0.0598)	Acc 84.38 (80.86)	
Epoch: [4][570/590]	Time 0.283 (0.298)	Data 0.0004 (0.0016)	Xent 0.5897 (0.6796)	Htri 0.0000 (0.0594)	Acc 79.69 (80.91)	
Epoch: [4][580/590]	Time 0.282 (0.298)	Data 0.0001 (0.0016)	Xent 0.5062 (0.6766)	Htri 0.0000 (0.0590)	Acc 85.94 (81.00)	
Epoch: [4][590/590]	Time 0.281 (0.298)	Data 0.0001 (0.0015)	Xent 0.4422 (0.6741)	Htri 0.0000 (0.0586)	Acc 85.94 (81.07)	
=> Test
Evaluating veri ...
Extracted features for query set, obtained 1678-by-2048 matrix
Extracted features for gallery set, obtained 11579-by-2048 matrix
=> BatchTime(s)/BatchSize(img): 0.026/100
Computing CMC and mAP
Results ----------
mAP: 48.4%
CMC curve
Rank-1  : 79.1%
Rank-5  : 90.0%
Rank-10 : 93.8%
Rank-20 : 96.7%
------------------
Checkpoint saved to "/mnt/fast/nobackup/users/rs01960/AdvanceCV/Logs/resnet50_4_amsgrad_0.0003/model.pth.tar-04.ckpt"
Elapsed 0:04:07
=> Show performance summary
veri (source)
- epoch 4	 rank1 79.1%
